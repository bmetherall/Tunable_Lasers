\pdfoutput=1
% ****** Start of file aipsamp.tex ******
%
%   This file is part of the AIP files in the AIP distribution for REVTeX 4.
%   Version 4.1 of REVTeX, October 2009
%
%   Copyright (c) 2009 American Institute of Physics.
%
%   See the AIP README file for restrictions and more information.
%
% TeX'ing this file requires that you have AMS-LaTeX 2.0 installed
% as well as the rest of the prerequisites for REVTeX 4.1
%
% It also requires running BibTeX. The commands are as follows:
%
%  1)  latex  aipsamp
%  2)  bibtex aipsamp
%  3)  latex  aipsamp
%  4)  latex  aipsamp
%
% Use this file as a source of example code for your aip document.
% Use the file aiptemplate.tex as a template for your document.
\documentclass[%
 aps,
 jmp,%
 amsmath,amssymb,
%preprint,%
 reprint,%
%author-year,%
%author-numerical,%
nofootinbib
]{revtex4-1}

\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
%\usepackage[mathlines]{lineno}% Enable numbering of text and display math
%\linenumbers\relax % Commence numbering lines

%\usepackage[subfolder,cleanup]{gnuplottex}
%\usepackage{wrapfig}
\usepackage{subcaption}
\usepackage{hyperref}
\usepackage{epstopdf}
%\usepackage{biblatex}

%\bibliography{Ref.bib}

\providecommand{\df}{\textrm{d}}
\newcommand{\diff}[3][]{\frac{\textrm{d}^{#1}#2}{\textrm{d}{#3}^{#1}}}
\newcommand{\pdiff}[3][]{\frac{\partial^{#1}#2}{\partial{#3}^{#1}}}
\newcommand{\Es}{E_{\textrm{sat}}}
\newcommand{\FT}[1]{\mathcal{F}\left\{ #1 \right\}}
\newcommand{\FTi}[1]{\mathcal{F}^{-1}\left\{ #1 \right\}}

\providecommand{\bigO}[1]{\ensuremath{\mathop{}\mathopen{}\mathcal{O}\mathopen{}\left(#1\right)}}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\sech}{sech}

\setlength{\abovecaptionskip}{5pt plus 3pt minus 2pt}

\begin{document}

%\preprint{AIP/123-QED}

\title[]{A Nonlinear Model for Dispersion-Tuned Actively Mode-Locked Lasers}% Force line breaks with \\
%\thanks{Footnote to title of article.}

\author{Brady Metherall}
 \email{brady.metherall@uoit.ca}
 \affiliation{University of Ontario Institute of Technology}
\author{C. Sean Bohun}%
 \email{sean.bohun@uoit.ca}
 \affiliation{University of Ontario Institute of Technology}

\date{\today}% It is always \today, today,
             %  but any date may be explicitly specified

\begin{abstract}
A new nonlinear model is proposed for tuneable lasers. Using the generalized non-linear Schr\"{o}dinger equation as a starting point, expressions for the transformations undergone by the pulse are derived for each component in the cavity. These transformations are then composed to give the overall effect of one trip around the cavity. The linear version of this model is solved analytically, and the nonlinear version numerically. A consequence of this model being nonlinear is that it is able to exhibit wave breaking which prior models could not. We highlight the rich structure of the boundary of stability for a particular plane of the parameter space.
\end{abstract}

%\pacs{Valid PACS appear here}% PACS, the Physics and Astronomy
                             % Classification Scheme.
%\keywords{Suggested keywords}%Use showkeys class option if keyword
                              %display desired
\maketitle

\section{Introduction}
Classical lasers, such as a laser pointer or a Helium-Neon gas laser, are limited to a single wavelength since the light is generated by stimulated emission. Tuneable lasers on the other hand, have the ability to operate within a range of wavelengths \cite{bohun, burgoyne2010, yamashita}. As a result, tuneable lasers have applications in spectroscopy and high resolution imaging such as coherent anti-Stokes Raman spectroscopy and optical coherence tomography \cite{bohun, burgoyne2014, yamashita}. This article is concerned with dispersion-tuned actively mode-locked (DTAML) lasers. The laser cavity consists of four elements: the dispersive element, the modulator, the gain fibre, and the optical coupler. The gain fibre consists of either an Erbium or Ytterbium doped fibre, and dispersion is generated by the highly dispersive chirped fibre Bragg grating (CFBG). \\

To start off the discussion of the current modelling efforts for a tuneable laser, we begin with a review of the efforts to describe an `average' model. The idea is to capture some of the physical elements in the waveform described by an effective PDE, the solution of which gives the amplitude of the wave packet. 

\section{Average Model}
The model for the amplitude in the `average' model is presupposed to have the form
\begin{equation}
\label{average}
	\pdiff{A}{z} = -i\frac{\beta_2}{2}\pdiff[2]{A}{T} - \frac{\epsilon}{2}T^2 A + \frac{g}{2}A
\end{equation}
where $A=A(T,z)$ is the complex amplitude of the pulse with $\beta_2 \in \mathbb{R}$ defining the dispersion, $\epsilon \in \mathbb{R}$, $\epsilon > 0$, determining the modulation and $g \in \mathbb{R}$, $g > 0$ giving the gain. Expression~(\ref{average}) is reminiscent of the nonlinear Schr\"odinger equation, but linear in $A$ so that the solution can take the form of a Gaussian wavepacket. Consequently, the ansatz for the amplitude is taken to be a function of the form
\begin{equation}
\label{ansatz}
	A(T,z) = \left(\frac{P_0}{1-i C}\right)^{1/2}\exp
	\left(-\frac{\delta \Omega^2 T^2}{2(1-i C)}\right)\textrm{e}^{i\psi z}
\end{equation}
so that the modulus, $|A|^2$, and the phase factor, $A/|A|$, are given by
\begin{align*}
	\left|A\right|^2 &= \left(\frac{P_0}{\sqrt{1 + C^2}}\right)
	\exp\left(-\frac{\delta \Omega^2 T^2}{(1 + C^2)}\right), \\
	\frac{A}{|A|} &= \left(\frac{1+iC}{\sqrt{1+C^2}}\right)^{1/2}\exp
	\left(-i\frac{\delta \Omega^2 T^2 C}{2(1+C^2)}\right)\textrm{e}^{i\psi z}.
\end{align*}
The quantity $C \in \mathbb{R}$ is known as the chirp and contributes a constant phase of $\varphi$ where $2\varphi = \arctan C$, $P_0$ is the maximum value of $|A|^2$ at $C=0$ (zero chirp), $\psi \in \mathbb{R}$ is the accumulated phase, and $\delta\Omega$ is the spectral half-width of $|A|^2$ since\footnote{If $f(t) = \textrm{e}^{-\alpha t^2}$ then $\hat{f}(\omega) = \frac{1}{2\pi}\int_{\mathbb{R}} f(t)\textrm{e}^{-i\omega t}\, \df t = \frac{1}{2\pi} (\frac{\pi}{\alpha})^{1/2}\textrm{e}^{-\omega^2/4\alpha}$.}
\begin{align*}
	\hat{A}(\omega,z) &= \frac{1}{2\pi}\int_{-\infty}^\infty A(t,z) \textrm{e}^{-i\omega t}\, \df t \\
	&= \left(\frac{P_0}{2\pi\delta \Omega^2}\right)^{1/2}
	\exp\left(-\frac{(1-i C)\omega^2}{2\delta \Omega^2}\right) \textrm{e}^{i\psi z},
\end{align*}
and $|\hat{A}(\delta\Omega,z)|^2 = \textrm{e}^{-1}|\hat{A}(0,z)|^2$. The corresponding half-width of the pulse duration comes from the expression for $|A|^2$ and gives
\begin{equation}
\label{duration}
	\delta T = \frac{\sqrt{1+C^2}}{\delta \Omega}.
\end{equation}

Applying the form~(\ref{ansatz}) to expression~(\ref{average}) provides the algebraic condition
\begin{align*}
	i\psi &= -i\frac{\beta_2}{2}\delta\Omega^2(1-iC)^{-1}
	\left(-1 + \delta\Omega^2(1-iC)^{-1}T^2\right) \\
	& \quad -\frac{\epsilon}{2}T^2 + \frac{g}{2} \\
	&= \frac{\beta_2\delta\Omega^2}{2(1+C^2)^2}(-C(1+C^2)+2\delta\Omega^2 T^2C) -\frac{\epsilon}{2}T^2 + \frac{g}{2}\\
	& \quad + i\frac{\beta_2\delta\Omega^2}{2(1+C^2)^2}(1+C^2 + \delta\Omega^2 T^2(C^2-1)).
\end{align*}
Treating this condition as a complex valued quadratic in $T$ gives four conditions. Assuming that $\psi\in\mathbb{R}$, the real and imaginary components at $\bigO{1}$ and $\bigO{T^2}$ yield
\begin{align*}
	&\bigO{T^2}_{\textrm{Im}}: 0 = C^2 - 1, &
	&\bigO{1}_{\textrm{Im}}: \psi = \frac{\beta_2\delta\Omega^2}{2(1+C^2)}, \\
	&\bigO{T^2}_{\textrm{Re}}: \epsilon = \frac{2\beta_2\delta\Omega^4C}{(1+C^2)^2}, &
	&\bigO{1}_{\textrm{Re}}: g = \frac{\beta_2\delta\Omega^2C}{(1+C^2)}.
\end{align*}
Starting with $\bigO{1}_{\textrm{Re}}$ we note that $g > 0$ implies that $\sgn(\beta_2 C) = \sgn(\beta_2)\sgn(C) = 1$. From $\bigO{T^2}_{\textrm{Im}}$, $C = \pm 1$ and therefore $C = \sgn(\beta_2)$, $\beta_2 C = |\beta_2|$ and $\epsilon > 0$, consistent with~(\ref{average}). The result is a two parameter family of solutions of the form~(\ref{ansatz}) with
\begin{align*}
	C &= \sgn(\beta_2),&
	\delta\Omega^2 &= \left(\frac{2\epsilon}{|\beta_2|}\right)^{1/2}, \\
	\psi &= \sgn(\beta_2)\left(\frac{\epsilon|\beta_2|}{8}\right)^{1/2},&
	g &= \left(\frac{\epsilon|\beta_2|}{2}\right)^{1/2}.
\end{align*}
Moreover, we also see that the representation~(\ref{ansatz}) as a classical solution of~(\ref{average}) imposes a subclass of solutions with $g = \left(\epsilon|\beta_2|/2\right)^{1/2}$. A useful pulse characterization is the half-width of the pulse duration, $\delta T$, which satisfies
\begin{align*}
	\delta T^2 &= \left(\frac{2|\beta_2|}{\epsilon}\right)^{1/2}.
\end{align*}

Since~(\ref{average}) is linear in $A$, any value of the peak power, $P_0$, is admissible. In practice, at high power levels, the gain drops as it saturates. One can model this with a gain term that takes the form
\begin{equation}
\label{newg}
	g(P_0) = \frac{g_0}{1+\frac{\textrm{power in fibre}}{\textrm{saturation power}}} - \alpha
\end{equation}
where $g_0$ is the low-power gain and $\alpha$ represents the net losses in the laser cavity. The power in the fibre depends on the frequency of the pulses, $f$, and modulus of the pulse so that
\begin{align*}
	f \int_{-\infty}^\infty |A(T)|^2\, \df T =
	\frac{\sqrt{\pi}f}{\delta\Omega}P_0 &= \Delta P_0, \\
	\Delta = \frac{\sqrt{\pi}f}{\delta\Omega} = \frac{\sqrt{\pi}f\delta T}{\sqrt{1+C^2}}&=
	\sqrt{\pi}f \left(\frac{|\beta_2|}{2\epsilon}\right)^{1/4}
\end{align*}
where $\Delta$ is the duty cycle of the pulse. Denoting the saturation power as $P_{\textrm{sat}}$,~(\ref{newg}) can be inverted to give
\[
	P_0 = \frac{P_{\textrm{sat}}}{\sqrt{\pi}f} \left(\frac{2\epsilon}{|\beta_2|}\right)^{1/4}
	\left(g_0\left(\left(\frac{\epsilon|\beta_2|}{2}\right)^{1/2} + \alpha\right)^{-1} - 1\right).
\]

\begin{figure}[tbp]
\centering
\input{Param}
\caption{The parameters are not to scale---this is only intended to show the structure.}
\label{fig:average}
\end{figure}

Figure~\ref{fig:average} shows a select set of possible waveforms in $(\epsilon,|\beta_2|)$ parameter space. The representative hyperbola, $\epsilon|\beta_2| = 2g^2$, correspond to constant gain while the rays through the origin, $|\beta_2|/\epsilon = \delta T^4/4$, correspond to constant width. Curves of constant power level are also indicated. One of the main drawbacks of this model is the fixed chirp and its symmetric behaviour with respect to $T$. One way to alleviate some of these restrictions is to construct a discrete model whereby each of the modules in the tuneable laser are given by a transfer function that is motivated by the PDE~(\ref{average}). In particular, the dispersion and the modulation would correspond to transfer functions of the form
\begin{align*}
	\widehat{A}_{\textrm{out}}(\omega) &= \widehat{A}_{\textrm{in}}(\omega)\textrm{e}^{i\beta_2\omega^2/2},&
	A_{\textrm{out}}(T) &= A_{\textrm{in}}(T)\textrm{e}^{-\epsilon T^2/2},
\end{align*}
respectively, where the dispersion is naturally defined in the frequency domain. Between the modules, the pulse is assumed to propagate according to the representation~(\ref{ansatz}) chosen to be consistent with the transfer functions. Details of this technique and its ability to predict a number of experimental effects can be found in~\cite{burgoyne2014}.

\section{A New Model}
Rather than using transfer functions with a linear PDE, we instead return to the generalized nonlinear Schr\"odinger equation~\cite{agrawal2013, ferreira, shtyrina, yarutkina} 
\begin{align}
\label{eq:nlse}
\pdiff{A}{z} &= - i \frac{\beta_2}{2}\pdiff[2]{A}{T} + \frac{\beta_3}{6}\pdiff[3]{A}{T} \\
\nonumber& \quad + i \gamma |A|^2 A + \frac{1}{2}g(A) A - \alpha A,
\end{align}
to represent the waveform. In this expression, $\beta_3$ is the third order dispersion coefficient, $\gamma$ is the coefficient of nonlinearity or self-phase modulation, $g(A)$ is the gain, and $\alpha$ is the loss of the fibre. Using this expression as a starting point, the laser cavity is assumed to be composed of five independent processes---gain, nonlinearity, loss, dispersion, and modulation. Within each component of the laser cavity the other four processes are assumed to be negligible, that is, each process is dominant only within one part of the laser, just as with the discrete model, but embracing any nonlinearities.

\subsection{Gain}
Considering the gain term as dominant as is expected with the Er-doped gain fibre, equation~\eqref{eq:nlse} reduces to
\begin{align}
\label{eq:gainde}
	\pdiff{A}{z} &= \frac{1}{2} \frac{g_0}{1 + E / \Es} A,& E &= \int_{-\infty}^\infty |A|^2 \, \df T,
\end{align}
where $g_0$ is a small signal gain, $E$ is the energy of the pulse and $\Es$ is the energy at which the gain begins to saturate~\cite{bohun, burgoyne2014, shtyrina, silfvast, yarutkina}.
%We shall first transform \eqref{eq:gainde} into an equation in terms of the energy. 
Multiplying~\eqref{eq:gainde} by $\bar{A}$, the complex conjugate of $A$, yields
\begin{align*}
	2\bar{A} \pdiff{A}{z} = \frac{g_0 |A|^2}{1 + E / \Es}.
\end{align*}
Adding this to its complex conjugate and integrating over $T$ gives
%\begin{align*}
%	\diff{|A|^2}{z} &= \frac{g_0 |A|^2}{1 + E / \Es}.
%\end{align*}
%After integrating this becomes
\begin{align}
\label{diffez}
	\diff{E}{z} &= \frac{g_0 E}{1 + E / \Es}.
\end{align}
For $E \ll \Es$ the energy grows exponentially, whereas for $E \gg \Es$ the gain has saturated and so the energy grows linearly. To obtain a closed form solution, \eqref{diffez} is integrated over a gain fibre of length $z$ and assume the energy increases from $E$ to $E_{\textrm{out}}$ so that
\[
	g_0 z = \log\frac{E_{\textrm{out}}}{E} + \frac{E_{\textrm{out}}-E}{\Es}
\]
and by exponentiating, rearranging, and applying $W_0$, the positive branch of the Lambert $W$ function,
\[
	 W_0\left(\frac{E}{\Es} \textrm{e}^{E/\Es} \textrm{e}^{g_0 z}\right) = 
	 W_0\left(\frac{E_{\textrm{out}}}{\Es} \textrm{e}^{E_{\textrm{out}}/\Es}\right) = \frac{E_{\textrm{out}}}{\Es}.
\]
This results in the closed form expression
\begin{align}
\label{eq:energy}
	E_{\textrm{out}}(z) = \Es W_0 \left( \frac{E}{\Es} \textrm{e}^{E/\Es} \textrm{e}^{g_0 z} \right)
\end{align}
with the desired property that $E_{\textrm{out}}(0)=E$. Since $E \sim |A|^2$, the gain in terms of the amplitude is given by
\begin{align}
	\nonumber G(A;E) &= \left(\frac{E_{\textrm{out}}(L_g)}{E}\right)^{1/2}A \\
	\label{eq:gain}
	&= \left( \frac{\Es}{E} W_0 \left( \frac{E}{\Es} \textrm{e}^{E/\Es} 
	\textrm{e}^{g_0 L_g} \right) \right)^{1/2} A,
\end{align}
where $L_g$ is the length of the gain fibre.

\subsection{Fibre Nonlinearity}
The nonlinearity of the fibre depends on the parameter $\gamma$. In regions where this affect is dominant expression~\eqref{eq:nlse} becomes
\begin{align}
\label{eq:fibrediff}
	\pdiff{A}{z} - i \gamma |A|^2 A = 0,
\end{align}
so that $\frac{\partial}{\partial z} |A|^2 = 0$ suggesting that $A(T,z) = A_0(T) e^{i \phi(T,z)}$. Substituting this representation into~\eqref{eq:fibrediff} and setting $\phi(T,0)=0$ gives $\phi(T,z) = \gamma |A|^2 z$. For a fibre of length $L_f$ the effect of the nonlinearity is therefore
\begin{align}
\label{eq:fibre}
	F(A) &= A e^{i \gamma |A|^2 L_f}.
\end{align}

\subsection{Loss}
Two sources of loss exist within the laser circuit: the loss due to the output coupler and the optical loss due to absorption and scattering. Combining these two effects give a loss that takes the form
\begin{align}
\label{eq:fibreloss}
	L(A) &= R e^{- \alpha L}A,
\end{align}
where $R$ is the reflectivity of the output coupler, and $L$ is the total length of the laser circuit.

\subsection{Dispersion}
Within the laser cavity, the dispersion is dominated by the chirped fibre Bragg grating (CFBG). In comparison, the dispersion due to the fibre is negligible\footnote{A $10$ cm chirped grating can provide as much dispersion as $300$ km of fibre~\cite{agrawal2002}.}. The dispersive terms of \eqref{eq:nlse} give
\begin{align}
\label{eq:disp}
	\pdiff{A}{z} = -i \frac{\beta_2}{2} \pdiff[2]{A}{T} + \frac{\beta_3}{6} \pdiff[3]{A}{T}
\end{align}
and since dispersion acts in the frequency domain, it is convenient to use the Fourier transform of~\eqref{eq:disp}, giving the result that
\begin{align*}
	\pdiff{}{z}\FT{A} &= i\frac{\omega^2}{2}\left(\beta_2 - \frac{\beta_3}{3} \omega\right) \FT{A}.
\end{align*}
The effect of dispersion is then
\begin{align}
\label{eq:dispersion}
	D(A) &= \FTi{\textrm{e}^{i \omega^2 L_D(\beta_2 - \beta_3 \omega/3)/2} \FT{A}}.
\end{align}
For a highly dispersive media the third order effects may need to be considered~\cite{agrawal2013, litchinitser}. However, for simplicity in the basic model and because of the nature of the grating, the third order effect will be neglected so we set $\beta_3=0$ for the subsequent analysis~\cite{agrawal2013, ferreira}.

\subsection{Modulation}
In the average model, the amount of modulation is characterized by the parameter $\epsilon$ through the term $\frac{\epsilon}{2}T^2 A$. In the new model, the modulation is considered to be applied externally through its action on the spectrum and for simplicity the representation is taken as the Gaussian
\begin{align}
	M(A) &= \textrm{e}^{-T^2 / 2 T_M^2} A,
\end{align}
where $T_M$ is a characteristic width of the modulation.%\footnote{Taking the Fourier transform, $\FT{\textrm{e}^{-T^2/ 2 T_M^2}} = \frac{1}{\sqrt{2\pi}}T_M\textrm{e}^{-\omega^2T_M^2/2}$.}

\subsection{Non-Dimensionalization}

\begin{table}
\begin{center}
\begin{tabular}{|l|l|}
\hline
Parameter & Value \\
\hline
$\Es$ & $10^3$--$10^4 \text{ pJ}$ \\
$\gamma$ & $0.001$--$0.01 \text{ W}^{-1} \text{m}^{-1}$ \cite{agrawal2013} \\
$g_0$ & $1$--$10 \text{ m}^{-1}$ \\
$\beta_2^g L_D$ & $10$--$2000 \text{ ps}^2$ \cite{burgoyne2014, agrawal2013, litchinitser} \\
$\beta_2^f$ & $-50$--$50 \text{ ps}^2/ \text{km}$ \cite{burgoyne2014, agrawal2013} \\
$T_M$ & $15$--$150 \text{ ps}$ \cite{burgoyne2014} \\
$L$ & $10$--$100 \text{ m}$ \\
$L_g$ & $1$--$4 \text{ m}$ \cite{burgoyne2014, shtyrina, yarutkina} \\
$L_f$ & $0.15$--$1 \text{ m}$ \\
\hline
\end{tabular}
\caption{Orders of magnitude of various parameters.}
\label{tab:values}
\end{center}
\end{table}

\begin{figure}[tbp]
\centering
\begin{subfigure}[]{\columnwidth}
\input{Shape}
\caption{Envelope}
\label{fig:envelope}
\end{subfigure} \\
\begin{subfigure}[]{\columnwidth}
\input{Transform}
\caption{Fourier Transform}
\label{fig:fourier}
\end{subfigure} \\
\begin{subfigure}[]{\columnwidth}
\input{Chirp}
\caption{Chirp}
\end{subfigure}
\caption{Simulation with $s = 0.09$, $a = 8 \times 10^3$, $h = 0.04$, and $E_0 = 0.1$ with $A_0 = \Gamma \sech{(2T)} \textrm{e}^{i \pi / 4}$. $\Gamma$ is chosen such that $\int_{-\infty}^\infty |A|^2 \, \textrm{d}T = E_0$, and hyperbolic secant is chosen since it is a common soliton. In the stable case $b = 1.32$, whereas for the broken case $b = 1.25$. The pulses are shown after 25 iterations.}
\label{fig:pulse}
\end{figure}

The structure of each process of the laser can be better understood by re-scaling the time, energy, and amplitude. Specifically, the time shall be scaled by the characteristic modulation time which is proportional to the pulse duration, the energy by the saturation energy, and the amplitude will be scaled so that it is consistent:
\begin{align*}
	T &= T_M \widetilde{T},& E &= \Es \widetilde{E},& A &= \left( \frac{\Es}{T_M} \right)^{1/2} \widetilde{A}.
\end{align*}
The new process maps, after dropping the tildes, become
\begin{align*}
	G(A) &= \left(E^{-1} W_0 \left( a E \textrm{e}^{E}\right) \right)^{1/2} A,&
	F(A) &= A \textrm{e}^{i b |A|^2}, \\
	D(A) &= \FTi{\textrm{e}^{i s^2 \omega^2} \FT{A}},&
	L(A) &= h A, \\
	M(A) &= \textrm{e}^{-T^2 / 2} A,
\end{align*}
with four dimensionless parameter groups (see Table~\ref{tab:values})
\begin{align*}
	a &= \textrm{e}^{g_0 L_g} \sim 8 \times 10^3,& s &= \sqrt{\frac{\beta_2 L_D}{2 T_M^2}} \sim 0.2, \\
	b &= \gamma L_f \frac{\Es}{T_M} \sim 1,& h &= R \textrm{e}^{-\alpha L} \sim 0.04,
\end{align*}
which control the behaviour of the laser.

\subsection{Combining the Effects}
In this model the pulse is iteratively passed through each process, the order of which is now important. In this first realization, the pulse is first amplified by the gain fibre, then since the pulse's magnitude is greatest the nonlinearity needs to be considered. The pulse is then tapped off by the output coupler, and then passes through the grating and is modulated. The pulse after one complete circuit of the laser cavity is then passed back in to restart the process. Functionally this can be denoted as
\begin{align*}
	\mathcal{L}(A) = M(D(L(F(G(A))))),
\end{align*}
where $\mathcal{L}$ is one loop of the laser. A solution to this model is one in which the envelope and chirp are unchanged after traversing every component in the cavity, that is, such that $\mathcal{L}(A) = A$---potentially with a constant phase shift.

\section{Results}

The linear version of the model described can be solved analytically, however, the full nonlinear version must be solved numerically. Somewhat surprisingly, its convergence as a function of the characteristic parameter groups is highly complex. To gain some insight into this process we first consider the linear analysis that ignores the nonlinear fibre effects.

\subsection{Linear Solution}

\begin{figure}[tbp]
\vspace{-8mm}
\centering
\input{Energy}
\caption{Energy as a function of $s$ and $b$ with $a = 8 \times 10^3$, $h = 0.04$, and $E_0 = 0.1$. The energy is constant along the black lines. Note this is the energy after a complete circuit of the laser cavity \emph{not} the energy outputted by the optical coupler.}
\label{fig:energy}
\end{figure}

Since the pulse is modulated by a Gaussian, it is expected that the equilibrium envelope will also be a Gaussian. Consider the initial pulse
\begin{align*}
	A_0 = \sqrt{P} \exp \left( -(1 + iC) \frac{T^2}{2 \sigma^2} \right).
\end{align*}
After passing through the gain and loss pieces---and having neglected the fibre nonlinearity---the pulse will have the form
\begin{align*}
	A_2 &= \sqrt{P} g(E) h \exp \left( -(1 + iC) \frac{T^2}{2 \sigma^2} \right), \\
	\text{where } g(E) &= \left( \frac{W_0(a E \textrm{e}^E)}{E} \right)^{1/2}
\end{align*}
is the gain component. After the pulse travels through the grating, the envelope will maintain its Gaussian shape, however, it will have spread \cite{agrawal2013}. This can be written as
\begin{align}
\label{linear1}
	A_3 = \sqrt{P} g(E) h \left( \frac{\sigma}{\widetilde{\sigma}} \right)^{1/2} \exp \left( -(1 + i \widetilde{C}) \frac{T^2}{2 \widetilde{\sigma}^2} \right),
\end{align}
where $\widetilde{\sigma}^2$ denotes the resulting variance, and $\widetilde{C}$ denotes the resulting chirp. Finally, the pulse is modulated---after one loop the total affect is given by
\begin{align}
\label{linear2}
	A_4 = \sqrt{P} g(E) h \left( \frac{\sigma}{\widetilde{\sigma}} \right)^{1/2} \exp \left( -(1 + i \widetilde{C}) \frac{T^2}{2 \widetilde{\sigma}^2} - \frac{T^2}{2} \right).
\end{align}

In equilibrium, it must be that $A_0 = A_4$.
%\begin{align*}
%	\sqrt{P} \exp \left( -(1 + iC) \frac{T^2}{2 \sigma^2} \right) = 
%	\sqrt{P} g(E) h \left( \frac{\sigma}{\widetilde{\sigma}} \right)^{1/2} \exp \left( -(1 + i \widetilde{C}) \frac{T^2}{2 \widetilde{\sigma}^2} - \frac{T^2}{2} \right).
%\end{align*}
More explicitly, this gives three conditions:
\begin{align}
\label{eq:energycond}
	\left( \frac{W_0(a E \textrm{e}^E)}{E} \right)^{1/2} h \left( \frac{\sigma}{\widetilde{\sigma}} \right)^{1/2} &= 1, \\
\label{eq:varcond}
	\frac{1}{\sigma^2} = \frac{1}{\widetilde{\sigma}^2} + 1, \qquad
	\frac{C}{\sigma^2} = \frac{\widetilde{C}}{\widetilde{\sigma}^2}.
\end{align}
The out-coming variance and chirp are given by \cite{agrawal2013}
\begin{align}
\label{eq:variance}
	\widetilde{\sigma}^2 &= \frac{\sigma^4 + 4 C s^2 \sigma^2 + 4 C^2 s^4 +4s^4}{\sigma^2}, \\
\label{eq:chirp}
	\widetilde{C} &= C + \left( 1 + C^2 \right) \frac{2s^2}{\sigma^2}.
\end{align}
From (\ref{eq:varcond}--\ref{eq:chirp}) we find that the equilibrium variance reduces to the quartic
\begin{align*}
\left( \sigma^2 \right)^4 + 4 s^4 \left( \sigma^2 \right)^3 - 20 s^4 \left( \sigma^2 \right)^2 + 32 s^4 \left( \sigma^2 \right) - 16 s^4 = 0,
\end{align*}
which has the solution
\begin{align*}
\sigma^2 &= \sqrt{2} s \left( s^6 + 3s^2 + \sqrt{4 + s^4}(1 + s^4) \right)^{1/2} \\
&\qquad - s^4 - s^2 \sqrt{4 + s^4}.
\end{align*}
Furthermore, from~\eqref{eq:energycond} the equilibrium energy is found to be
\begin{align}
	\label{eq:equilenergy}
	E = \frac{h^2 \zeta}{1 - h^2 \zeta} \ln \left( a h^2 \zeta \right),
\end{align}
where $\displaystyle \zeta \equiv \frac{\sigma}{\widetilde{\sigma}}$.

\subsection{Nonlinear Solution}

\begin{figure*}
\begin{subfigure}[]{0.5\textwidth}
\input{Big}
\end{subfigure}%
\begin{subfigure}[]{0.5\textwidth}
\input{Zoom}
\end{subfigure}
\caption{Regions of convergence in the $s$--$b$ parameter space for $a = 8 \times 10^3$, $h = 0.04$, and $E_0 = 0.1$ with $A_0 = \Gamma \sech{(2T)} \textrm{e}^{i \pi / 4}$. Along the black lines $T_M$ is the only parameter varying.}
\label{fig:DMmap}
\end{figure*}

In the linear model, the pulse will converge to a Gaussian as long as $a h^2 \zeta > 1$ so that the equilibrium energy from \eqref{eq:equilenergy} is positive. However, this is not necessarily the case with the inclusion of the nonlinearity. The fibre adds a phase shift proportional to the power of the pulse, this in turn can inject higher frequency oscillations due to the dispersion which then reinforces the oscillations. These oscillations are then intensified with each trip around the laser until the envelope of the pulse becomes mangled. \\

Figure \ref{fig:pulse} shows the envelope, Fourier transform, and chirp for a stable wave as well as a broken wave. In the case of the stable wave the envelope and the Fourier transform are Gaussian-esque, and the chirp is a very smooth function in close agreement with \cite{chen}. However, in the case of the broken wave the envelope and Fourier transform are oscillatory. Furthermore, the chirp is highly erratic. \\

The breaking of the wave is not as predictable as one may expect---the structure of the boundary is quite rich. Note that in Figure \ref{fig:pulse} the wave breaks for the smaller of the two $b$ values. This structure is highlighted in Figure \ref{fig:DMmap} where the error is calculated by
\begin{align*}
\frac{\|A(\text{iteration } 40) - A(\text{iteration } 39) \|_2}{\|A(\text{iteration } 39) \|_2}.
\end{align*}
Additionally, Figure \ref{fig:energy} shows the energy of the pulse within the parameter space. \\

One interesting feature is that in the region $0.25 < s < 0.55$ the wave does not break regardless of $b$. This is because $b|A|^2$ is approximately constant for a particular $s$ value, and so the phase shift added by the nonlinearity is constant, thus the wave is stable. \\

Since some of the individual mappings are nonlinear they do not commute---changing the order of the components should lead to different results. The nonlinearity should still follow the gain component since that is where it is most dominant. Furthermore, the loss is a linear mapping and so it will commute with both dispersion and modulation. Therefore, the only other unique case to consider is if dispersion follows modulation. \\

Figure \ref{fig:switch} shows the effect of switching these two components. Overall, the large scale structure is unchanged with the exception of $0.3 < s < 0.55$ and $20 < b$. In this region the waveform appears to have reached a period 2 equilibrium, that is, $\mathcal{L}(\mathcal{L}(A)) = A$.

\begin{figure*}
\centering
\begin{subfigure}[]{0.5\textwidth}
\input{Switch}
\end{subfigure}%
\begin{subfigure}[]{0.5\textwidth}
\input{SwitchZoom}
\end{subfigure}
\caption{Regions of convergence with modulation preceding dispersion, same parameters as Figure \ref{fig:DMmap}.}
\label{fig:switch}
\end{figure*}

\section{Conclusion}

We proposed a new nonlinear model for tuneable lasers derived from the generalized nonlinear Schr\"{o}dinger equation. It was demonstrated that this model is able to predict the phenomenon wave breaking due to the inclusion of the nonlinearity. We then showed the rich structure of the boundary between a sustainable pulse, and a pulse that breaks. This model will hopefully aid in the design of tuneable lasers.
\newpage

%\printbibliography

\bibliography{Ref}

\end{document}
